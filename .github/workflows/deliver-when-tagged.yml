name: deliver

on:
  push:
    tags:
      - v*
  workflow_dispatch:

permissions:
  contents: read

jobs:
  build-android:
    uses: ./.github/workflows/build-android.yml
    secrets: inherit
    with:
      upload-artifact: true

  upload-android:
    needs: build-android
    uses: ./.github/workflows/upload-android.yml
    secrets: inherit
    with:
      filename: ${{ needs.build-android.outputs.filename }}
      release-name: ${{ needs.build-android.outputs.release-name }}
      package-name: ${{ needs.build-android.outputs.package-name }}

  build-ios:
    uses: ./.github/workflows/build-ios.yml
    secrets: inherit
    with:
      upload-artifact: true

  upload-ios:
    needs: build-ios
    uses: ./.github/workflows/upload-ios.yml
    secrets: inherit
    with:
      filename: ${{ needs.build-ios.outputs.filename }}
